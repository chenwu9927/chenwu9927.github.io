<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>【计算机网络】第四章-网络层(上) | BlankChen</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/pure-min.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="https://unpkg.com/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="https://unpkg.com/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="https://unpkg.com/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="https://unpkg.com/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">【计算机网络】第四章-网络层(上)</h1><a id="logo" href="/.">BlankChen</a><p class="description">相逢的人会再相逢。</p></div><div id="nav-menu"><a href="/."><i class="fa fa-home">Home</i></a><a class="current" href="/notes/"><i class="fa fa-sticky-note-o"> Notes</i></a><a href="/thoughts/"><i class="fa fa-lightbulb-o"> Thoughts</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">【计算机网络】第四章-网络层(上)</h1><div class="post-meta">2025-03-24<span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 10.1k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 35</span><span class="post-meta-item-text"> Minutes</span></span></span></div><a class="disqus-comment-count" href="/2025/03/24/2121/#waline"><span class="waline-comment-count" id="/2025/03/24/2121/"></span><span> Comment</span></a><div class="post-content"><h1 id="4-1-网络层的功能"><a href="#4-1-网络层的功能" class="headerlink" title="4.1 网络层的功能"></a>4.1 网络层的功能</h1><h2 id="网络层的功能"><a href="#网络层的功能" class="headerlink" title="网络层的功能"></a>网络层的功能</h2><ul><li><strong>主要任务</strong>：将分组从源主机经过多个网络和多段链路传输到目的主机<ul><li>分组转发：路由器根据转发表将分组从合适的端口转发出去（数据平面），转发的依据是IP地址（网络层通过IP地址来标识主机）</li><li>路由选择：根据路由协议构造路由表，经常&#x2F;定期与相邻路由器交换信息，更新维护路由表（转发平面）</li></ul></li><li>网络抽象划分：可以将网络抽象划分为数据平面（转发平面）和控制平面。</li></ul><h2 id="TCP-IP体系的网络层"><a href="#TCP-IP体系的网络层" class="headerlink" title="TCP&#x2F;IP体系的网络层"></a>TCP&#x2F;IP体系的网络层</h2><ol><li>提供无连接的数据报服务，由用户主机来保证通信的可靠性。</li><li>只向上提供简单灵活的、无连接的、尽最大努力交付的数据报服务</li><li>所传送分组可能出错、丢失、重复、失序或超时。</li></ol><h2 id="异构网络互连（网络层的任务之一）"><a href="#异构网络互连（网络层的任务之一）" class="headerlink" title="异构网络互连（网络层的任务之一）"></a>异构网络互连（网络层的任务之一）</h2><ul><li><p><strong>网络互连</strong>：将两个以上的计算机网络，通过一定的方法，用一些中继系统相互连接起来，以构成更大的网络系统。<strong>通常是指用路由器进行网络连接路由选择。</strong></p></li><li><p><strong>异构网络</strong>：数据链路层和物理层均不同。</p><p>【异构性】指（在物理层和数据链路层中定义的）传输介质、数据编码方式、链路控制协议及不同的数据单元格式和转发机制。</p></li><li><p><strong>中继系统</strong></p><ul><li>物理层中继系统：转发器，集线器</li><li>数据链路层中继系统：网桥和交换机</li><li>网络层中继系统：路由器</li><li>网络层以上的中继系统：网关</li></ul></li></ul><h2 id="虚拟互联网络"><a href="#虚拟互联网络" class="headerlink" title="虚拟互联网络"></a>虚拟互联网络</h2><ol><li>也就是逻辑互联网络。</li><li>互联起来的各种物理网络的异构性本来是客观存在的，但是通过IP协议就可使这些性能各异的网络在网络层上看起来像是一个统一的网络。</li><li>使用IP协议的虚拟互联网络简称为IP网络<ul><li>优点：IP网上主机进行通信时，就好像在单个网络上通信一样。看不见具体异构细节。</li></ul></li></ol><h2 id="路由与转发"><a href="#路由与转发" class="headerlink" title="路由与转发"></a>路由与转发</h2><table><thead><tr><th>概念</th><th>说明</th></tr></thead><tbody><tr><td>分组转发</td><td>路由器根据转发表将分组从合适的端口转发出去</td></tr><tr><td>路由选择</td><td>根据路由协议构造路由表，经常&#x2F;定期与相邻路由器交换信息，更新维护路由表</td></tr><tr><td>路由表</td><td>根据路由选择算法得出</td></tr><tr><td>转发表</td><td>从路由表得出</td></tr></tbody></table><p>路由表的表项包括：</p><ul><li>目的地址：表示IP包的目的地址或目的网络；</li><li>网络掩码：与目的地址一起标识目的主机或者路由器所在的网段的地址</li><li>pre：标示路由加入IP路由表的优先级（因为到达一个目的地有多条路由）</li><li>cost：路由开销，同上，但是给出的是开销</li><li>interface：输出接口，指明IP包将从路由器哪个接口转发</li><li>nexthop：下一跳IP地址，说明IP包所经过的下一个路由器</li></ul><p>请注意：</p><ul><li>路由器只保留到达目的地址的下一个路由器的地址，不保留整个传输路径的信息。采用目的网络，则只需包含目的网络和到达该目的网络路径上的下一个路由器的IP地址即可。</li><li>每个路由器根据路由表来选择IP分组的下一跳地址。主机仅知道到达本地网络的路径，要去往其他网络，那么需要把IP分组交给路由器。路由器和源主机都不知道IP分组要经过的完整路径。</li></ul><h2 id="网络层向其上层提供的两种服务"><a href="#网络层向其上层提供的两种服务" class="headerlink" title="网络层向其上层提供的两种服务"></a>网络层向其上层提供的两种服务</h2><ol><li>面向连接的虚电路服务</li><li>无连接的数据报服务</li></ol><table><thead><tr><th></th><th>数据报服务</th><th>虚电路服务</th></tr></thead><tbody><tr><td>连接的建立</td><td>不需要</td><td>必须有</td></tr><tr><td>目的地址</td><td>每个分组都有完整的目的地址</td><td>仅在建立连接阶段使用,之后每个分组使用长度较短的虚电路号</td></tr><tr><td>路由选择</td><td>每个分组独立地进行路由选择和转发</td><td>属于同一条虚电路的分组按照同一路由转发</td></tr><tr><td>分组顺序</td><td>不保证分组的有序到达</td><td>保证分组的有序到达</td></tr><tr><td>可靠性</td><td>不保证可靠通信，可靠性由用户主机来保证</td><td>可靠性由网络保证</td></tr><tr><td>对网络故障的适应性</td><td>出故障的结点丢失分组,其他分组路径选择发生变化时可以正常传输</td><td>所有经过故障结点的虚电路均不能正常工作</td></tr><tr><td>差错处理和流量控制</td><td>由用户主机进行流量控制，不保证数据报的可靠性</td><td>可由分组交换网负责，也可由用户主机负责</td></tr></tbody></table><h1 id="虚电路与数据报"><a href="#虚电路与数据报" class="headerlink" title="虚电路与数据报"></a>虚电路与数据报</h1><h2 id="虚电路服务"><a href="#虚电路服务" class="headerlink" title="虚电路服务"></a>虚电路服务</h2><ul><li><p><strong>概述</strong>：两台计算机进行通信时首先建立网络层的连接（一条逻辑上的虚电路，VC，不是物理连接。），连接建立后就固定了虚电路对应的物理路径</p><p>比较：采用电路交换的电话通信<strong>则</strong>是建立一条真正的物理连接。</p></li><li><p><strong>特点</strong>：</p><ul><li>“虚”：指的是这条电路<strong>不是专用</strong>的。一段物理链路可以有很多条虚电路。<br>节点到其他节点之间的链路可能同时有若干条虚电路通过，亦或是建立。<strong>也不需要为每条VC预分配带宽。</strong></li><li>核心思想：可靠通信由网络自身来保证。</li></ul></li></ul><p><strong>通信过程</strong>（三个阶段）：</p><ol><li>虚电路建立<ul><li>每次建立将一个未用过的虚电路号（VCID）分配给虚电路。</li><li>分组的首部仅在连接建立时使用完整的目的地址，之后每个分组的首部只需携带虚电路编号即可。</li><li>【动作】 A发“呼叫请求”分组，B收到并同意连接，发送“呼叫应答”分组进</li></ul></li><li>数据传输<ul><li>建立虚电路后，AB可以相互传送数据分组</li></ul></li><li>虚电路释放<ul><li>结束后，A发“请求释放”分组拆除虚电路；</li><li>整个连接逐个断开。</li></ul></li></ol><p><strong>虚电路服务的特点</strong></p><table><thead><tr><th>特点</th><th>详述</th></tr></thead><tbody><tr><td>时间开销大</td><td>建立和拆除需要时间开销；<br>对于交互式应用、少量短分组场景浪费；<br>对于长时间频繁数据交换效率高。</td></tr><tr><td>路由选择的体现</td><td>路由选择体现在建立阶段。</td></tr><tr><td>可靠、对端点的流量控制<br>（保证分组有序到达）</td><td>提供可靠通信功能，保证每个分组正确、有序地到达；<br>可以对两个端点流量进行控制，通知发送方暂缓发送</td></tr><tr><td><strong>致命弱点</strong></td><td>某个节点或某条链路出现故障、彻底失效时，会破坏经过这个节点或链路的虚电路。</td></tr><tr><td>相对数据报方式开销小</td><td>分组首部不包含目的地址，而是虚电路号。</td></tr></tbody></table><h2 id="数据报服务"><a href="#数据报服务" class="headerlink" title="数据报服务"></a>数据报服务</h2><p><strong>概述</strong></p><ul><li>网络在发送分组前不需要先建立连接；</li><li>源主机的高层协议将报文拆成若干较小的数据段，并加上地址等控制信息后构成分组；</li><li>中间阶段存储分组很短一段时间，找到路由后尽快转发给每个分组。</li><li><strong>网络层不提供服务质量承诺</strong>。不提供端到端的可靠传输服务。所以路由器比较简单，造价低廉。复杂的网络功能置于因特网边缘（用户主机及其内部运输层）</li></ul><p><strong>通信过程</strong>：A向B发送分组</p><table><thead><tr><th>步骤</th><th>详述</th></tr></thead><tbody><tr><td>主机A发给交换节点</td><td>主机A先将分组逐个发往与之直接相连的交换节点，交换节点缓存分组</td></tr><tr><td>查找转发表</td><td>交换节点查找自己的转发表，转发给别的交换节点</td></tr><tr><td>继续转发直到抵达B</td><td>其他交换节点也类似地继续转发，直到B收到</td></tr></tbody></table><p><strong>数据报服务特点</strong></p><table><thead><tr><th>特点</th><th>详述</th></tr></thead><tbody><tr><td>无须建立连接</td><td>发送方随时发送，接收方随时接收</td></tr><tr><td>不保证可靠</td><td>网络只是尽最大努力交付。分组可能丢失。由于每个分组路由选择转发都是独立的，所以路径可能不同，分组也不一定按序到达</td></tr><tr><td>需完整地址</td><td>需要包括发送方和接收方的完整地址，这样才能独立传输</td></tr><tr><td>视情况丢弃</td><td>分组在交换节点处的存储转发需要排队等候，产生时延，网络拥塞时视情况丢弃部分分组</td></tr><tr><td>适应能力强</td><td>对于冗余和故障路径，相应地更新转发表，对故障适应能力强</td></tr></tbody></table><p><strong>优点</strong>：网络造价大大降低。运行方式灵活。适用多种应用场景。</p><h1 id="SDN（软件定义网络）"><a href="#SDN（软件定义网络）" class="headerlink" title="SDN（软件定义网络）"></a>SDN（软件定义网络）</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>一种创新网络架构。采用<strong>集中式的控制平面</strong>和<strong>分布式的数据平面</strong>。两平面<strong>彼此分离</strong>。</p><h2 id="控制平面"><a href="#控制平面" class="headerlink" title="控制平面"></a>控制平面</h2><p>SDN利用<strong>控制—数据接口</strong>对数据平面上的路由器进行集中式控制，方便软件控制网络。</p><h2 id="传统网络中的路由器"><a href="#传统网络中的路由器" class="headerlink" title="传统网络中的路由器"></a>传统网络中的路由器</h2><ul><li><p>既有转发表又有路由选择软件；</p></li><li><p>既有数据平面又有控制平面。</p></li></ul><h2 id="SDN结构"><a href="#SDN结构" class="headerlink" title="SDN结构"></a>SDN结构</h2><p>不再需要路由选择软件（路由器之间不再相互交换路由信息）；</p><p>路由器只是做简单工作：收到分组、查找转发表、转发分组。那么如何得知路由信息？</p><p>网络控制平面有一个逻辑上的<strong>远程控制器(不在SDN交换机中，而位于网络中心位置)</strong>：</p><ul><li>掌握各主机和整个网络状态，并为每个分组计算出最佳路由；</li><li>通过Openflow协议（这是南向接口协议）把转发表下发给路由器。它取代了路由协议。</li></ul><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul><li><strong>可编程性</strong>：为开发者提供强大编程接口。北向接口、南向接口、东西向接口<ul><li>北向接口：SDN对上层应用开发者提供北向接口（有丰富的API，不必关心底层硬件细节）；</li><li>南向接口：SDN控制器和转发设备建立双向会话的接口。通过南向接口SDN控制器可兼容不同硬件设备</li><li>东西向接口：SDN控制器集群内部控制器之间的通信接口。用于增强整个控制平面的可靠性和可拓展性。</li></ul></li><li><strong>优点</strong>：<ol><li>全局集中式控制和分布式高速转发</li><li>灵活可编程与性能平衡：由专有的自动化工具以编程方式配置</li><li>降低成本：网络设备的制造与功能软件的开发相分离</li></ol></li><li><strong>缺点</strong>：<ol><li>安全风险：集中管理受攻击崩溃会影响整个网络</li><li>规模瓶颈：网络规模扩大后，控制器将成为网络性能的瓶颈</li></ol></li></ul><h1 id="拥塞控制"><a href="#拥塞控制" class="headerlink" title="拥塞控制"></a>拥塞控制</h1><p><strong>拥塞</strong>：过量分组引起网络性能下降</p><p><strong>判断拥塞状态</strong>：</p><ul><li>随着网络负载增加，网络吞吐量明显小于正常吞吐量 -&gt; 轻度拥塞</li><li>网络吞吐量随着网络负载增大反而下降 -&gt; 可能已进入拥塞</li></ul><p><strong>拥塞控制目标</strong>：</p><ul><li>获取发生拥塞的信息，利用信息进行控制；确保网络能够承载所达到的流量</li><li>【比较】流量控制指发送方和接收方之间的点对点通信量控制，抑制发送方的发送速率。</li></ul><p><strong>拥塞控制方法</strong>：</p><ul><li>开环控制：（静态方法）设计时就事先考虑到发生拥塞的因素：确定何时可接受新流量、何时可丢弃分组。(做决定时不考虑当前网络状态)</li><li>闭环控制：（动态方法，反馈回路）采用监测系统来监视，检测到拥塞后把拥塞信息发送给合适地方，来调整网络运行。</li></ul><h1 id="4-1总结补充"><a href="#4-1总结补充" class="headerlink" title="4.1总结补充"></a>4.1总结补充</h1><p>一、<strong>路由器</strong>互联的多个局域网的结构中要求每个局域网（物理层、数据链路层、网络层协议可以不同，但是网络层之上的协议必须相同）原因：路由器是第三层设备，他只能影响所在的网络层及以下，再往上并不能影响到。</p><ul><li>关于网络层协议不同而实现互联的eg：IPV4和IPV6网络</li></ul><p>二、路由器和交换机</p><table><thead><tr><th>路由器</th><th>工作在网络层，不转发广播包，能够分隔广播域，抑制广播风暴； 路由器互连多个网络，不仅有多个IP地址，还有多个硬件地址</th></tr></thead><tbody><tr><td>交换机</td><td>工作在数据链路层，能够分隔冲突域，不能分隔广播域</td></tr><tr><td>集线器</td><td>工作在物理层，不能分隔广播域也不能分隔冲突域</td></tr></tbody></table><p>三、电路交换、报文交换、数据报交换、虚电路交换</p><table><thead><tr><th>电路交换</th><th>无差错控制功能。</th></tr></thead><tbody><tr><td>报文交换</td><td>交换的数据单元是报文，报文大小不固定（需要较大存储空间），因为大小不固定所以处理时间也不固定，不能用于实时通信环境。</td></tr><tr><td>分组交换</td><td>分为下面两种方式：数据报交换和虚电路交换。 分组交换限制分组大小，超过限制时需分隔。</td></tr><tr><td>数据报交换</td><td>无连接，不可靠；每个分组都是独立选择路由；可能丢失、失序。故障后可以另选路径。 要保证可靠性和有序性需要高层协议（TCP）的支持。</td></tr><tr><td>虚电路交换</td><td>面向连接，可靠；保证可靠有序。 建立连接后，分组走的路径就是固定的。 不适合出错率高的系统，因为很容易出现结点故障。</td></tr></tbody></table><p>四、存储转发机制：<strong>先接收完整个分组</strong>才开始转发分组的第一位</p><h1 id="4-2-IPv4"><a href="#4-2-IPv4" class="headerlink" title="4.2 IPv4"></a>4.2 IPv4</h1><p><strong>概述</strong>：也即网际协议(Internet Protocol,IP), 定义了数据传送的基本单元(IP分组)及其确切数据格式。IPV4地址是给因特网上的每一个主机&#x2F;路由器的每一个接口分配的一个全世界范围内的唯一32比特（IPV6为128比特）的标识符。</p><p><strong>IP数据报</strong>：IP分组也叫IP数据报。包括首部和数据部分。</p><ul><li>首部前两个字节往往以0x45开头，可用于定位IP数据报开始的位置。</li><li>补充：“4”表示版本号，0100。首部的第一个字节前4位表示IP协议的版本。首部长度以32位（四个字）为单位，标准IP首部长度为20字节，20字节&#x2F;4字节&#x3D;5 (行，一行一个字)</li><li>标识：占16bit，作为一个计数器，也是数据报的编号。每产生一个数据报就++，若长度超出MTU，则需要分片，但是分片后的几个数据报的标识都相同，以便重组。（是数据报的编号不是分片的编号）</li><li>标志：占3bit 。标志最低位MF（1表示后面还有分片，0表示最后一个分片），中间位DF&#x3D;0时才允许分片。</li><li>片偏移：占13bit。 指出较长的数据报在分片后某片在原数据报中的相对位置，以8B为偏移单位。除最后一个分片外，每个分片的长度一定是8B的整数倍。</li><li>生存时间（TTL）：8bit，数据报在网络中可通过的路由器数的最大值，也就是数据报的寿命，限制数据报的无限转发。路由器转发数据报前都要使得TTL–，减到0时丢弃。</li><li>协议：8bit，指出携带的数据使用何种协议，应当上交给哪个协议处理。6：TCP 17:UDP</li><li>首部检验和：16bit，但是只检验首部不包括数据。经过一次路由器都要重新计算一次。</li><li>源地址字段：发送方 目的地址字段：接收方 都是IP地址，都占4B</li></ul><table><thead><tr><th>字段基本单位</th><th>首部长度</th><th>总长度</th><th>片偏移</th></tr></thead><tbody><tr><td>偏移量</td><td>4B</td><td>1B</td><td>8B</td></tr></tbody></table><h2 id="IP数据报分片"><a href="#IP数据报分片" class="headerlink" title="IP数据报分片"></a>IP数据报分片</h2><p><strong>最大传送单元（MTU）</strong>：</p><ul><li>一个链路层数据帧能承载的最大数据量。链路层MTU严格限制IP数据报长度。</li><li>取决于链路层协议。 以太网MTU：1500B 许多广域网：&lt;&#x3D;576B</li><li>IP数据报总长度超出MTU时需要分装在多个较小IP数据报中，也就是分片。</li></ul><p><strong>分片重组：</strong></p><ul><li><p>目的主机使用IP首部中的标识、标志和片偏移字段完成重组。</p></li><li><p>过程：目的主机检查数据报的<code>标识号</code>确定哪些数据报属于同一个原始数据报的片。<code>标志位</code>的后两位DF和MF。</p><ul><li>只有DF&#x3D;0时能被分片。</li><li>MF告知是否是最后一个片。MF&#x3D;1说明有后续。</li><li>片偏移字段指出片应该放在原书IP数据报的哪个位置。</li></ul></li></ul><h2 id="IPv4地址"><a href="#IPv4地址" class="headerlink" title="IPv4地址"></a>IPv4地址</h2><p><strong>概述：</strong> 长度为32，唯一。格式为： {&lt;网络号&gt;，&lt;主机号&gt;}</p><ul><li>网络号：标志主机&#x2F;路由器连接到的网络。网络号在整个互联网范围内唯一。</li><li>主机号：标志主机。在网络号指明的网络范围内唯一。</li></ul><p><strong>特殊用途IP地址：</strong></p><table><thead><tr><th>地址</th><th>用途</th></tr></thead><tbody><tr><td>主机号全0</td><td>表示本网络本身。&lt;网络号，0…&gt;</td></tr><tr><td>主机号全1</td><td>表示本网络广播地址（直接广播地址） &lt;网络号，255&gt;</td></tr><tr><td>127.x.x.x</td><td>环回自检地址(Loopback Test)，用于测试网络连接性和配置，不会被路由器转发到其他网络。目的地址为环回地址的IP数据报永远不会也不可能出现在任何网络上。</td></tr><tr><td>全0：0.0.0.0</td><td>本网络上的本主机</td></tr><tr><td>全1：255.255.255.255</td><td>表示整个TCP&#x2F;IP网络的广播地址，也称受限广播地址。实际等效于本网络广播地址。</td></tr></tbody></table><p><strong>三种IP地址：</strong></p><table><thead><tr><th>网路类别</th><th>最大可用网络数</th><th>第一个可用的网络号</th><th>最后一个可用的网络号</th><th>每个网络中的最大主机数</th></tr></thead><tbody><tr><td>A</td><td>2^7-2</td><td>1</td><td>126</td><td>2^24-2</td></tr><tr><td>B</td><td>2^14</td><td>128.0</td><td>191.255</td><td>2^16-2</td></tr><tr><td>C</td><td>2^21</td><td>192.0.0</td><td>223.255.255</td><td>2^8-2</td></tr></tbody></table><p><strong>IP地址特点：</strong></p><table><thead><tr><th>IP地址特点</th><th>概述</th></tr></thead><tbody><tr><td>一种分等级地址结构</td><td>由网络号和主机号构成。IP地址管理机构只分配网络号，主机号有网络自行分配，便于管理。路由器仅根据主机的网络号来转发分组，减少路由表存储占用。</td></tr><tr><td>标志主机或链路接口</td><td>同时连接到两个不同的网络时必须同时具有两个相应IP地址，这时路由器具有两个或以上的IP地址，每个端口都有不同网络号的IP地址（因为是不同网络</td></tr><tr><td>LAN中</td><td>转发器&#x2F;桥接器（网桥等）连接的若干LAN仍是同一个网络，同一个广播域。在LAN中所有主机网络号相同（同一网络），主机号必须不同（不同个体）</td></tr><tr><td>网络平等</td><td>所有分配到网络号的网络平等</td></tr><tr><td>同一局域网</td><td>IP地址里的网络号必须相同</td></tr><tr><td>注意点</td><td>分类编址问题中，划分网络的时候，注意要同时把一群主机连接路由器也划到这群主机里。如下所示：这个网络需要254+1&#x3D;255个地址</td></tr></tbody></table><h2 id="NAT网络地址转换"><a href="#NAT网络地址转换" class="headerlink" title="NAT网络地址转换"></a>NAT网络地址转换</h2><p>**概述：**通过专用网络地址转换为公用地址，从而对外隐藏内部管理的IP地址。</p><ul><li>意义：整个专用网只需要一个全球IP地址就可和互联网</li></ul><p>**私有IP地址(可重用地址)：**用于LAN，不用于WAN</p><ul><li>不能直接用于Internet，必须通过网关利用IP地址转换为Internet中合法的全球IP地址。</li><li>并且允许私有IP地址被LAN重复使用。</li><li>互联网中所有路由器对目的地址为私有地址的数据报一律不进行转发。</li></ul><table><thead><tr><th>类别</th><th>私有IP地址网段</th></tr></thead><tbody><tr><td>1个A类网段</td><td>10.0.0.0~10.255.255.255</td></tr><tr><td>16个B类网段</td><td>172.16.0.0~172.31.255.255</td></tr><tr><td>256个C类网段</td><td>192.168.0.0~192.168.255.255</td></tr></tbody></table><p>**专用互联网：**也称本地互联网，即采用私有IP地址的互联网。</p><p><strong>使用NAT：</strong></p><ul><li>需要在专用网–&gt;互联网的路由器上安装NAT软件。</li><li>NAT路由器至少有一个有效的外部全球IP地址。可使多个私有IP映射到一个全球IP。</li><li>NAT路由器使用NAT转换表进行本地IP地址到全球IP地址的转换</li><li>NAT转换表示例： 每个 LAN 局域网 IP 地址 : 端口号 , 与 WAN 广域网 IP 地址 : 端口号 的对应关系</li><li>WAN 广域网地址 172.38.1.5 : 44444 , 对应 LAN 局域网地址 192.168.0.3 : 22222</li></ul><ul><li>网段：10.0.0.0&#x2F;8, 172.16.0.0&#x2F;12, 192.168.0.0&#x2F;16</li></ul><p><strong>NAT路由器工作原理</strong>：</p><ol><li>某家庭获得一个全球IP地址，家庭里的三台主机使用私有地址（10.0.0.0网段）。</li><li>用户主机10.0.0.1想发送数据到128.119.40.186:80 ；</li><li>NAT为IP分组生成新端口号，更改源地址为NAT的全球IP地址，更改源端口号为新端口号，并增加表项；</li><li>对方不知道分组已经变换，也不知道专用地址是多少，照常返回数据；</li><li>NAT重新转换，改回原来的端口号和原来的专用地址。</li></ol><h2 id="划分子网-（目的是减少广播域的大小，结果是增加网络数量）"><a href="#划分子网-（目的是减少广播域的大小，结果是增加网络数量）" class="headerlink" title="划分子网 （目的是减少广播域的大小，结果是增加网络数量）"></a>划分子网 （目的是减少广播域的大小，结果是增加网络数量）</h2><p>**概述：**两级IP地址的空间利用率低；给每个网络都划分一个网络后会使得路由表变得过大，降低性能。【改进】增加“子网号字段”，这就得到了三级IP地址。</p><p><strong>基本思路：</strong></p><ol><li>子网划分是内部事务，外部并不知道</li><li>从主机号借用若干位作为子网号。 地址结构变为&lt;网络号&gt;,&lt;子网号&gt;,&lt;主机号&gt;</li><li>路由器的分组转发仍然是按照目的网络号。 只是本单位路由器收到IP数据报后再次根据目的网络号和子网号找到目的子网，然后交付给目的主机。</li></ol><p><strong>子网掩码：</strong></p><ul><li><p>格式：一个与IP地址相对应的32位二进制比特串，由一串1和随后的一串0组成。1对应于IP地址中的网络后及子网号，0对应主机号。</p></li><li><p>用法：由IP地址和子网掩码进行与**（<strong><strong>AND</strong></strong>）**运算可以得出相应的子网的网络地址。</p><p>指明分类IP地址的主机号部分被借用了多少位作为子网号。</p></li><li><p>注意点</p><ul><li>路由器之间交换路由信息时必须将所在网络的子网掩码告诉对方</li><li>一台主机在设置IP地址信息的同时必须设置子网掩码。</li><li>同属于一个子网的所有主机及路由器的相应端口设置相同的子网掩码</li><li>路由器的路由表包含目的网络地址、子网掩码、下一跳地址</li></ul></li></ul><h2 id="无分类编址CIDR-无分类域间路由选择-CIDR无类别域间路由"><a href="#无分类编址CIDR-无分类域间路由选择-CIDR无类别域间路由" class="headerlink" title="无分类编址CIDR (无分类域间路由选择) CIDR无类别域间路由"></a>无分类编址CIDR (无分类域间路由选择) CIDR无类别域间路由</h2><p>**CIDR概述：**在变长子网掩码的基础上提出的一种消除传统A B C类地址及划分子网的概念。使用网络前缀的概念代替网络的概念。分配一个【块】，而不是分配一整类地址。</p><ul><li>与传统分类IP地址的最大区别：网络前缀的位数不固定，可以任意选取</li></ul><p>**记法：**IP地址&#x3D; &lt;网络前缀&gt;, &lt;主机号&gt;</p><p><strong>斜线记法(CIDR记法)</strong>：“IP地址&#x2F;网络前缀所占用的位数”</p><ul><li><p>网络前缀所占用位数对应网络号部分 &#x3D;&#x3D;子网掩码中连续1的部分</p></li><li><p>eg. 128.14.32.5&#x2F;20 掩码为20个连续的1以及随后12个连续的0,“&#x2F;”表示通过逐位“与”的方式来得到该地址的网络前缀。丫就是截取前20位。</p><p>这个IP地址可以写成10000000.00001110.00010000.00000101（写成二进制），子网掩码20为11111111.11111111.11110000.00000000（20个1），与后得到128.14.32.0（网络前缀）</p></li><li><p>可以进一步计算这个IP地址所在地址块的范围（地址块里的最小地址和最大地址）</p><table><thead><tr><th>最小地址(128.14.32.0)</th><th>最大地址(128.14.47.255)</th></tr></thead><tbody><tr><td><u>10000000.00001110.0010</u>0000.00000000</td><td><u>10000000.00001110.0010</u>1111.11111111</td></tr></tbody></table></li><li><p>注意点</p><ul><li>CIDR地址块中的地址数一定是2的整次幂。故可指派地址数一般为2^N-2 （剔除全0和全1）</li><li>地址块里的地址数越多，则网络前缀也就越短</li></ul></li></ul><h2 id="路由聚合-也称构成超网"><a href="#路由聚合-也称构成超网" class="headerlink" title="路由聚合(也称构成超网)"></a>路由聚合(也称构成超网)</h2><p><strong>概述：<strong>路由表中可以利用CIDR地址块来查找目的网络。这种</strong>地址的聚合</strong>称为路由聚合。</p><p><strong>作用</strong>：使路由表中一个项目可以表示多个 原本传统分类地址 的路由，减少路由之间的信息交换，通过网络性能。 （基于CIDR的视角来合并部分网络的路由表项）</p><p><strong>分析</strong>：不使用路由聚合，那么R1到网络1和网络2需要两条路由表项；注意到R1到两个网络的下一跳都是R2，网络1和网络2前16位相同（可以构成一个更大的地址块206.1.0.0&#x2F;16）</p><p><strong>最长前缀匹配</strong>：（也叫最佳匹配）使用CIDR时路由表各项由“网络前缀”和“下一跳地址”组成，查找路由表时可能会得到不止一个匹配结果。应当从匹配结果中<strong>选择具有最长网络前缀的路由</strong>（地址块越小，路由越具体）。</p><ul><li><p>途径：通常<strong>将无分类编制路由表存放在</strong>一种<strong>层次数据结构</strong>中（二叉线索），自上而下查找。</p></li><li><p>采用CIDR编制，可以按照前缀的长短把前缀最长的放在第一行。只有检索到匹配的就停止检索。</p></li></ul><h2 id="子网划分方法：定长的子网掩码，变长的子网掩码"><a href="#子网划分方法：定长的子网掩码，变长的子网掩码" class="headerlink" title="子网划分方法：定长的子网掩码，变长的子网掩码"></a>子网划分方法：定长的子网掩码，变长的子网掩码</h2><h3 id="定长子网掩码"><a href="#定长子网掩码" class="headerlink" title="定长子网掩码"></a>定长子网掩码</h3><p><strong>概述：</strong></p><ol><li>各子网使用相同的子网掩码。</li><li>各子网分配的IP地址数量相同（造成地址资源的浪费）</li></ol><p><strong>过程：</strong></p><ol><li>某单位拥有一个CIDR地址块208.115.21.0&#x2F;24 不难看出主机号占最后八位</li><li>划分子网。 有4个单位，则划分成4个子网。从主机号的高位借两位作为子网划分。</li><li>现在主机号还剩下6位。这样每个子网可分配的地址数为2^8-2</li></ol><h3 id="变长的网络掩码划分子网"><a href="#变长的网络掩码划分子网" class="headerlink" title="变长的网络掩码划分子网"></a>变长的网络掩码划分子网</h3><p>**概述：**每个子网可以使用不同的子网掩码。并且每个子网所分配的IP地址数量可以不同。</p><p><strong>过程：</strong></p><ol><li><p>某单位拥有一个CIDR地址块208.115.21.0&#x2F;24 不难看出主机号占最后八位。要划分给三个部门。</p></li><li><p>部门1的主机号需要6位，剩下26位作网络前缀。部门2需要5位，剩下27位作前缀。部门3的主机号需.位，剩余29位作前缀。</p></li><li><table><thead><tr><th>地址范围</th><th>划分方法</th></tr></thead><tbody><tr><td><u>208.115.21.00</u>000000 ~ <u>208.115.21.00</u>111111</td><td></td></tr><tr><td><u>208.115.21.010</u>00000 ~ <u>208.115.21.010</u>11111</td><td></td></tr><tr><td><u>208.115.21.01100</u>000 ~ <u>208.115.21.01100</u>111</td><td></td></tr><tr><td><u>208.115.21.010</u>00000 ~ <u>208.115.21.010</u>11111</td><td></td></tr></tbody></table></li><li><p>这种划分方案从大的开始划。部门1需要6位主机号，所以有2^6-2&#x3D;62个可分配地址，剩下2位用来划分子网，并且部门1为00.</p></li></ol><h2 id="网络层转发过程"><a href="#网络层转发过程" class="headerlink" title="网络层转发过程"></a>网络层转发过程</h2><p>**概述：**分组转发基于目的主机所在网络（压缩转发表大小），<strong>转发表信息 (目的网络地址，下一跳地址)</strong>，路由器根据IP地址的网络前缀来查表找到下一跳地址。</p><p><strong>两种特殊路由：</strong></p><ul><li><p>【特定主机路由】对特定目的主机的IP地址专门指明一个路由。</p><p>作用：方便管理员控制和测试网络</p></li><li><p>【默认路由】用特殊前缀0.0.0.0&#x2F;0表示默认路由。 当目的网络是其他网络(不是自身)也不在转发表中就一律选择默认路由</p><p>作用：通常用于路由器到互联网的路由（因为路由表不可能包含互联网上所有路由）</p></li></ul><p><strong>路由器分组转发算法：</strong></p><ol><li>从IP分组首部提取目的目的主机的IP地址</li><li>查找【特定主机路由】，找得到则按照这一项转发；找不到则开始按前缀长度顺序查找</li><li>对于查找中的一行，将【一行的子网掩码】与【目的地址】逐位【与】（AND），如果与结果和这一行的前缀匹配，结束查找。按下一跳转发。否则继续找下一行。</li><li>如果有一个【默认路由】，就传递给默认路由，没有，则【转发分组出错】。</li></ol><p><strong>注意：</strong></p><ul><li>因为转发表只给出下一跳地址，并非完整路径，所以传到一个路由器都要查一次它的转发表</li><li><strong>！！ 得到下一跳IP地址后，将它通过ARP转换成MAC地址然后填到MAC帧首部，再根据这个MAC地址去找到下一跳的路由器</strong></li></ul><h2 id="IP地址与硬件地址"><a href="#IP地址与硬件地址" class="headerlink" title="IP地址与硬件地址"></a>IP地址与硬件地址</h2><p><strong>各种地址</strong>：</p><table><thead><tr><th>IP地址</th><th>MAC地址（硬件地址）</th></tr></thead><tbody><tr><td>网络层及之上使用的地址，是分层式的。位于IP数据报首部。IP数据报封装成MAC帧之后，数据链路层是看不见IP地址的。</td><td>在数据链路层使用，平面式的。位于MAC帧首部。</td></tr></tbody></table><p>**网络层寻址：**网络层只使用IP地址来寻址（因为路由器的隔离，无法通过广播MAC地址来跨网络寻址）。</p><p><strong>寻址过程：</strong></p><ol><li>寻址时，每个路由器依据它的路由表选择到<strong>目标网络需要转发到的下一跳</strong></li><li>IP数据报通过多次路由转发<strong>到达目标网络后</strong>改为在目标局域网中通过数据链路层的MAC地址以广播的方式寻址</li></ol><p><strong>性质：</strong></p><ol><li>在IP层抽象的互联网上只能看到IP数据报</li><li>IP数据报首部有源IP地址，但是路由器只使用目的IP地址来转发</li><li>局域网的链路层只能看到MAC帧，MAC帧中是封装的IP数据报。MAC帧首部的源地址和目的地址会不断地改变，因为IP数据报在每次转发过程中都会被拆解重新封装（路由器根据下一跳IP地址通过ARP转换成MAC地址填进MAC帧首部）</li><li>无法使用MAC地址跨网络通信。因为每次转发都要修改MAC地址，如上所述。</li><li>IP层抽象的互联网屏蔽了下层复杂的细节，在网络层上可以使用统一抽象的IP地址来研究不同主机的通信</li></ol><h2 id="ARP-地址解析协议"><a href="#ARP-地址解析协议" class="headerlink" title="ARP  地址解析协议"></a>ARP 地址解析协议</h2><p><strong>ARP概述：</strong></p><ol><li>一种方法，旨在完成IP地址到MAC地址的映射。如果目的主机和源主机不在同一个局域网上，要通过ARP找到本局域网的某个路由器硬件地址，发分组传给它，并由这个路由器把分组转发给下一个网络。</li><li>ARP工作在网络层（看得见IP地址）；NAT工作在传输层（看得见端口）.</li></ol><p><strong>ARP表：<strong>每个主机都有的一个ARP高速缓存，存放</strong>本局域网</strong>上各主机和路由器的IP地址到MAC地址的映射表</p><p>**原理：**A向本局域网主机B发送IP数据报： （ARP请求分组：<code>广播发送</code> ARP响应分组：<code>单播发送</code>）</p><ol><li>查ARP高速缓存，如果有B的IP地址，直接得到对应硬件地址，把它写入MAC帧，并发送给B</li><li>如果没有，通过使用目的MAC地址为FF-FF-FF-FF-FF-FF的帧封装和广播ARP请求分组。所有主机都会收到ARP请求。</li><li>B收到后向A发送ARP响应分组，在分组里告诉A它(B)的IP地址和MAC地址映射关系，这样A可以写入它的ARP缓存，从而发送MAC帧</li></ol><p><strong>补充：</strong></p><ul><li>ARP用来解决同一局域网主机&#x2F;路由器的IP地址和硬件地址映射问题。不在一个局域网，则通过ARP找到某个路由器的硬件地址，发给这个路由器，让它转给下一个网络。</li><li>IP地址到硬件地址的解析自动进行，用户并不知道。</li><li>主机或路由器和本网络另一个已知IP地址的主机或路由器进行通信时，ARP自动将IP地址解析成数据链路层需要的硬件地址</li></ul><h2 id="动态主机配置协议-DHCP"><a href="#动态主机配置协议-DHCP" class="headerlink" title="动态主机配置协议 DHCP"></a>动态主机配置协议 DHCP</h2><p><strong>DHCP概述：</strong></p><ol><li>用于给主机动态地分配IP地址。</li><li>提供即插即用的联网机制，允许一台计算机加入新的网络和自动获取IP地址</li><li>应用层协议（通过客户&#x2F;服务器模式工作），基于UDP</li></ol><p><strong>工作原理：</strong></p><ol><li>使用客户&#x2F;服务器模型</li><li>需要IP地址的主机启动时向【DHCP服务器】广播发送【发现报文】，从而成为【DHCP客户】；</li><li>所有主机都能收到这个广播报文，但是只有【DHCP服务器】可以回答。</li><li>【DHCP服务器】在自己的数据库里查找这台主机的配置信息，找得到返回，找不到则从服务器的IP地址池中取一个地址分配给这台计算机。</li><li>【提供报文】DHCP服务器的回答报文。</li></ol><p><strong>过程：</strong></p><ol><li>DHCP客户广播发现报文（源地址0.0.0.0，目的地址255.255.255.255）</li><li>服务器收到这个广播报文，广播【提供报文】，这里面包括给DHCP客户的IP地址，报文源地址为DHCP服务器地址，目的地址为255.255.255.255</li><li>DHCP客户收到提供报文，如果接受这个IP地址，就需要广播“DHCP请求”给DHCP服务器。源地址0.0.0.0，目的地址255.255.255.255（同1.）</li><li>DHCP服务器广播“DHCP确认”消息，把IP地址分配给这个客户。源地址目的地址同2.</li></ol><p><strong>注意点：</strong></p><ol><li>可以有多台DHCP服务器，可能有多个应答消息，但是DHCP客户只挑选其中一个（最先到达的）</li><li>DHCP分配给客户的IP地址是【临时的】，客户只能在【租用期】内使用，租用期由服务器决定，客户也可以在报文中提出租用期要求。</li><li>交互过程采用广播方式。采用UDP。</li></ol><h2 id="ICMP-网际控制报文协议"><a href="#ICMP-网际控制报文协议" class="headerlink" title="ICMP 网际控制报文协议"></a>ICMP 网际控制报文协议</h2><p><strong>ICMP概述：</strong></p><ol><li>目的：有效转发IP数据报，提高交付成功机会。</li><li>允许主机或路由器报告差错和异常情况</li><li>虽然ICMP报文封装在IP数据报中发送，但ICMP是依然是网络层协议。</li><li>ICMP报文有两种：【ICMP差错报告报文】【ICMP询问报文】</li></ol><p><strong>ICMP差错报告报文及其五种类型</strong>：用于目标主机或到目标主机路径上的路由器。目的是向源主机报告差错和异常情况。</p><ol><li>终点不可达：路由器&#x2F;主机不能交付数据时向源主机发送</li><li>源点抑制：路由器&#x2F;主机因为【拥塞】而丢弃数据报。 源点抑制报文告诉源点应该降低数据报的发送速率。</li><li>时间超过：<ul><li>路由器收到生存时间TTL为0的数据报，除丢弃这个数据报外还需要向源点发送时间超过报文。</li><li>终点在<strong>预先规定的时间内不能</strong>收到<strong>一个数据报</strong>的<strong>全部数据报片</strong>时，就把已收到的数据报片全部丢弃，然后向源点发送时间超过报文。</li></ul></li><li>参数问题：收到的数据报首部有的字段的值不正确，则丢弃并发送参数问题报文</li><li>改变路由（重定向）：告诉主机下次应该把数据报发送给另外的路由器，可通过更好地路由</li></ol><p><strong>ICMP差错报告报文不应该发送：</strong></p><p>​	情况一：对ICMP差错报告报文不再发送ICMP差错报告报文</p><p>​	情况二：第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报文</p><p>​	情况三：对于具有多播地址的数据报都不发送ICMP差错报告报文</p><p>​	情况四：对于特殊地址的数据报也不发送</p><p><strong>ICMP询问报文的四种类型</strong>：</p><ol><li>回送请求和回答报文</li><li>时间戳请求和回答报文</li><li>地址掩码请求和回答报文</li><li>路由器询问和通告报文</li></ol><p><strong>ICMP常见应用：</strong></p><ol><li>分组网间探测PING：测试两台主机间的连通性。工作在应用层，直接使用网络层的ICMP。</li><li>Traceroute：跟踪分组经过的路由。 工作在网络层。</li></ol><h2 id="4-2-习题查漏补缺"><a href="#4-2-习题查漏补缺" class="headerlink" title="4.2  习题查漏补缺"></a>4.2 习题查漏补缺</h2><p>一、IPv4计算首部检验和</p><ol><li>先把IP数据报首部划分为许多16位字的序列，并把检验和字段置零。把所有16位字相加后，将得到的和的反码写入检验和字段。</li><li>接收方收到数据报后，将首部的所有16位字再使用反码算术运算相加一次。将得到的和取反码，即得出接收方检验和的计算结果。</li><li>若首部未发生任何变化，则此结果必为0</li></ol><p>二、多IP：如果一个主机有两个以上的IP地址，那么这些IP地址应当属于不同的网络。所以他们的网络号一定不同。</p><h1 id="4-3-IPv6（从根本上解决地址耗尽问题）"><a href="#4-3-IPv6（从根本上解决地址耗尽问题）" class="headerlink" title="4.3 IPv6（从根本上解决地址耗尽问题）"></a>4.3 IPv6（从根本上解决地址耗尽问题）</h1><h2 id="IPv6特点"><a href="#IPv6特点" class="headerlink" title="IPv6特点"></a>IPv6特点</h2><table><thead><tr><th>特点</th><th>描述</th></tr></thead><tbody><tr><td>更大地址空间</td><td>从IPv4的32位增大到128位。 地址空间是前者的2^96倍。</td></tr><tr><td>灵活首部</td><td>IPv6首部长度固定，40B。选项放在有效载荷中，选项灵活可变（IPv4选项固定，放在首部可变部分.<strong>IPv4<strong><strong>的首部长度是可变的，必须是</strong></strong>4B****的整数倍</strong>）</td></tr><tr><td>允许协议扩充</td><td>允许不断扩充功能。IPv4固定</td></tr><tr><td>支持即插即用</td><td>也即自动配置。无需使用DHCP（动态主机配置协议 ，DHCP服务器&amp;DHCP客户）</td></tr><tr><td>分片</td><td>只有源主机才能分片，是端到端的。 不允许类似IPv4传输路径中的路由分片。</td></tr><tr><td>增大了安全性</td><td>身份鉴别和保密功能是IPv6的扩展首部</td></tr><tr><td>兼容性</td><td>IPv6与IPv4不兼容，但是与所有其他互联网协议兼容(TCP UDP ICMP IGMP DNS)</td></tr><tr><td>无首部检验和</td><td>IPv6协议没有首部检验和,这意味着攻击者无法通过篡改数据包来伪造或篡改数据,这有助于提高网络的安全性。 这一措施也加快了路由器处理数据报的速度。链路层会丢弃检测出差错的帧，并且传输层也有相应的差错处理机制，所以网络层额差错检测可以精简掉。</td></tr></tbody></table><h2 id="IPv6地址类型"><a href="#IPv6地址类型" class="headerlink" title="IPv6地址类型"></a>IPv6地址类型</h2><ol><li>单播</li><li>多播</li><li>任播(新增)</li></ol><h2 id="过渡技术"><a href="#过渡技术" class="headerlink" title="过渡技术"></a>过渡技术</h2><ol><li>双协议栈</li><li>隧道技术</li></ol><h1 id="4-4-路由算法和协议"><a href="#4-4-路由算法和协议" class="headerlink" title="4.4 路由算法和协议"></a>4.4 路由算法和协议</h1><h2 id="路由算法分类"><a href="#路由算法分类" class="headerlink" title="路由算法分类"></a>路由算法分类</h2><table><thead><tr><th>类型</th><th>特点</th><th>示例</th></tr></thead><tbody><tr><td>静态</td><td>手工配置</td><td>-</td></tr><tr><td>动态</td><td>自动调整</td><td>RIP, OSPF, BGP</td></tr></tbody></table><h2 id="路由协议对比"><a href="#路由协议对比" class="headerlink" title="路由协议对比"></a>路由协议对比</h2><table><thead><tr><th>协议</th><th>类型</th><th>特点</th></tr></thead><tbody><tr><td>RIP</td><td>距离向量</td><td>跳数限制15</td></tr><tr><td>OSPF</td><td>链路状态</td><td>支持分层区域</td></tr><tr><td>BGP</td><td>路径向量</td><td>AS间路由</td></tr></tbody></table><h1 id="4-5-IP多播"><a href="#4-5-IP多播" class="headerlink" title="4.5 IP多播"></a>4.5 IP多播</h1><h2 id="多播地址"><a href="#多播地址" class="headerlink" title="多播地址"></a>多播地址</h2><ul><li>IPv4：D类地址(224.0.0.0~239.255.255.255)</li><li>IPv6：FF00::&#x2F;8</li></ul><h2 id="多播协议"><a href="#多播协议" class="headerlink" title="多播协议"></a>多播协议</h2><ol><li>IGMP：组成员管理</li><li>多播路由协议：构建多播树</li></ol><h1 id="4-6-移动IP"><a href="#4-6-移动IP" class="headerlink" title="4.6 移动IP"></a>4.6 移动IP</h1><h2 id="关键概念"><a href="#关键概念" class="headerlink" title="关键概念"></a>关键概念</h2><ul><li>家乡代理</li><li>外地代理</li><li>转交地址</li><li>三角路由问题</li></ul><h1 id="4-7-网络层设备"><a href="#4-7-网络层设备" class="headerlink" title="4.7 网络层设备"></a>4.7 网络层设备</h1><h2 id="路由器功能"><a href="#路由器功能" class="headerlink" title="路由器功能"></a>路由器功能</h2><ul><li>连接异构网络</li><li>分组转发</li><li>路由选择</li><li>分隔广播域</li></ul><h2 id="路由表vs转发表"><a href="#路由表vs转发表" class="headerlink" title="路由表vs转发表"></a>路由表vs转发表</h2><table><thead><tr><th></th><th>路由表</th><th>转发表</th></tr></thead><tbody><tr><td>用途</td><td>路由选择</td><td>分组转发</td></tr><tr><td>生成</td><td>路由算法</td><td>从路由表得出</td></tr><tr><td>实现</td><td>软件</td><td>软件&#x2F;硬件</td></tr></tbody></table></div><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://bloggerhsx.com/2025/03/24/2121/" data-id="cmbzbt3ec000coszb011hcjvv" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByElEQVR42u3aS27DMAwFwNz/0i7QVYHU7iNpKUYxWgVBbI2yIMTP6xWv43udff9zvX9//dRrxcLFxR1zj8v1zk22uX72+nhnv8HFxd3PTbZMAtD1UZMj/WHDxcV9GPfs970wh4uL+z+41UtJnvzg4uI+k5ts3KPk4e/mXA0XF3fArRZMV3xeWN/FxcUtco/iyouh1bJptDsuLu4WbnL56DVI8mSpeoXCxcVdzZ0XN0ft0vgmg4uLu5O7bibqLDj2QtjyES5cXNxWQyW/rMxHvqJAhouLu4w7GdMslzPip07/LFxc3I3cXgBK7kqT4Nh8HS4u7k3chJKnN/OxTlxc3M9yqyXRObQXzk5TIFxc3AXcXiV10l6tXoNwcXE/y62+Lr+g9Ia3fnkDLi7uFm5y1ciDUW8UozregYuLu5rbe1E1mclLLbi4uM/h5iEpL3dWjxpVR3FxcTdye4MUhW2KB2tOjOLi4t7E7RU7qtlVoSTaasri4uKu4ObFi6Qw2jsYLi7uM7nVZmo12M2buLi4uM/kJolTc7QiT59wcXEfyc2LqnnztZA44eLibuROGq45KC+w3pCr4eLiDri9QczJUfO/ABcXdzv3C5AabMNmRdCqAAAAAElFTkSuQmCC">Share</a><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/408/" rel="tag">408</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82/" rel="tag">网络层</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li></ul></div><div class="post-nav"><a class="pre" href="/2025/03/25/1556/">【数据结构】第一章-基本概念</a><a class="next" href="/2025/03/24/1954/">开坑|计算机考研408专业课笔记</a></div><div class="nofancybox" id="waline"></div><link rel="stylesheet" type="text/css" href="https://unpkg.com/@waline/client@v3/dist/waline.css"><script type="module">import{init}from"https://unpkg.com/@waline/client@v3/dist/waline.js";init({el:"#waline",comment:!0,serverURL:"comments.polarwanderer.cn",pageSize:"8",wordLimit:"120",requiredMeta:requiredMeta,emoji:["//unpkg.com/@waline/emojis@1.2.0/weibo","//unpkg.com/@waline/emojis@1.2.0/qq","//unpkg.com/@waline/emojis@1.2.0/tw-emoji"]})</script><script>let metaInfo=["nick","mail","link"],requiredMeta="nick,mail".split(",").filter(i=>metaInfo.indexOf(i)>-1)</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0" readonly></div></div><div class="search-modal" id="search-modal"><div class="search-modal-content"><div class="search-modal-header"><input class="search-modal-input" id="modal-search-input" placeholder="输入关键词搜索..." type="text" name="q"></div><div class="search-modal-body"><div id="modal-search-result"></div></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o">Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o">Tags</i></div><div class="tagcloud"><a href="/tags/408/" style="font-size:15px">408</a> <a href="/tags/%E4%BA%BA%E7%89%A9/" style="font-size:15px">人物</a> <a href="/tags/%E5%8E%86%E5%8F%B2/" style="font-size:15px">历史</a> <a href="/tags/%E5%93%B2%E5%AD%A6/" style="font-size:15px">哲学</a> <a href="/tags/%E5%9B%9E%E5%BF%86/" style="font-size:15px">回忆</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size:15px">学习笔记</a> <a href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" style="font-size:15px">年终总结</a> <a href="/tags/%E6%80%9D%E8%80%83/" style="font-size:15px">思考</a> <a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size:15px">感悟</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" style="font-size:15px">数学建模</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size:15px">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size:15px">机器学习</a> <a href="/tags/%E6%A2%A6%E5%A2%83/" style="font-size:15px">梦境</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size:15px">生活</a> <a href="/tags/%E7%A4%BE%E4%BC%9A%E7%8E%B0%E8%B1%A1/" style="font-size:15px">社会现象</a> <a href="/tags/%E7%AB%9E%E8%B5%9B/" style="font-size:15px">竞赛</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size:15px">笔记</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E8%A1%A8/" style="font-size:15px">线性表</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82/" style="font-size:15px">网络层</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size:15px">计算机网络</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%80%83%E7%A0%94/" style="font-size:15px">计算机考研</a> <a href="/tags/%E8%AE%B0%E5%BD%95/" style="font-size:15px">记录</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size:15px">随笔</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o">Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2025/03/25/1558/">【数据结构】第二章-线性表</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/03/25/1556/">【数据结构】第一章-基本概念</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/03/24/2121/">【计算机网络】第四章-网络层(上)</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/03/24/1954/">开坑|计算机考研408专业课笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/07/29/0021/">浪迹天涯</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/07/08/2317/">寻书</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/06/25/2338/">半年志</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/02/07/2150/">2024年美赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/12/31/2342/">抓住2023的小尾巴</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/11/12/1620/">11月12日</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o">Recent Comments</i></div><div id="widget-waline-list"></div><script type="text/javascript" id="recent-comment" serverurl="comments.polarwanderer.cn" count="5" src="/js/recent-comments.js?v=1.0.0" async></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2025 <a href="/." rel="nofollow">BlankChen.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><script type="text/javascript" src="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path;searchFunc(path,"local-search-input","local-search-result")</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script><script type="text/javascript" src="/js/sticky-header.js?v=1.0.0"></script><script type="text/javascript" src="/js/toc-generator.js?v=1.0.0"></script><script type="text/javascript" src="/js/snowfall.js?v=1.0.0"></script><script type="text/javascript" src="/js/text-reader.js?v=1.0.0"></script><script type="text/javascript" src="/js/floating-buttons.js?v=1.0.0"></script><script type="text/javascript" src="/js/thoughts-typewriter.js?v=1.0.0"></script><script type="text/javascript" src="/js/subtitle-typewriter.js?v=1.0.0"></script></div></body></html>