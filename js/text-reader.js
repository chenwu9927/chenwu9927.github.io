(()=>{let o=!1,t=window.speechSynthesis,l=null;function e(){if(t){var n=(()=>{let e=document.querySelector(".post-content");if(!(e=e||document.querySelector("main")||document.querySelector(".content")||document.body))return"";let n=e.cloneNode(!0),t=(["script","style","nav","header","footer",".toc","#toc-container",".code-block","pre","code",".highlight",".gist",".social-share",".post-nav",".comments",".sidebar",".widget",".ad",".advertisement"].forEach(e=>{n.querySelectorAll(e).forEach(e=>e.remove())}),n.textContent||n.innerText||"");return t=t.replace(/\s+/g," ").replace(/[\r\n]+/g,"。 ").trim()})();if(n){c(),(l=new SpeechSynthesisUtterance(n)).rate=1,l.pitch=1,l.volume=1;n=t.getVoices();let e=n.find(e=>(e.lang.includes("zh")||e.name.includes("Chinese")||e.name.includes("中文"))&&(e.name.toLowerCase().includes("male")||e.name.toLowerCase().includes("男")||e.name.includes("Male")||e.name.includes("男性")));(e=(e=e||n.find(e=>e.lang.includes("zh")||e.name.includes("Chinese")||e.name.includes("中文")))||n.find(e=>e.lang.includes("en")&&(e.name.toLowerCase().includes("male")||e.name.includes("Male"))))&&(l.voice=e),l.onend=function(){o=!1,r()},l.onerror=function(e){console.error("朗读出错:",e.error),o=!1,r()},t.speak(l),o=!0}else alert("没有找到可朗读的内容")}else alert("您的浏览器不支持语音朗读功能")}function c(){t&&t.cancel(),l=null,o=!1}function r(){var e,n,t=document.getElementById("reader-button");t&&(n="dark"===document.documentElement.getAttribute("data-theme"),o?(t.style.background="rgba(85, 85, 85, 0.9)",t.classList.add("active"),t.title="🔊 停止朗读 - 点击停止语音朗读",(e=t.querySelector("svg"))&&(e.style.fill="#f0f0f0")):(n?(t.style.background="rgba(45, 45, 45, 0.9)",(e=t.querySelector("svg"))&&(e.style.fill="#e0e0e0")):(t.style.background="rgba(255, 255, 255, 0.9)",(n=t.querySelector("svg"))&&(n.style.fill="#333")),t.classList.remove("active"),t.title="🔊 开始朗读 - 点击开始语音朗读页面内容"))}window.toggleReading=function(){(o?c:e)(),r()},window.updateReaderButton=r,window.addEventListener("beforeunload",function(){c()}),t&&0===t.getVoices().length&&t.addEventListener("voiceschanged",function(){})})();